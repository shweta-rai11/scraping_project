from Bio import Entrez
import re
import pandas as pd
import requests
from bs4 import BeautifulSoup
import pandas as pd
import os

def search_geo_accessions(keyword, retmax=2000, retstart=0):
    Entrez.email = "swetaraibms@example.com"  
    search_results = []
    handle = Entrez.esearch(db="gds", term=keyword, retmax=retmax, retstart=retstart)
    record = Entrez.read(handle)
    handle.close()
    # Extract GEO accession numbers from search results
    id_list = record.get("IdList", [])
    return id_list, int(record.get("Count", 0))

def fetch_geo_accession_details(id_list):
    Entrez.email = "swetaraibms@example.com"  # Replace with your email
    accession_numbers = set()  # Use a set to store unique accession numbers
    
    if id_list:
        handle = Entrez.efetch(db="gds", id=id_list, rettype="full", retmode="text")
        data = handle.read()  
        handle.close()
        accession_pattern = re.compile(r"GSE\d{6,7}")
        found_accessions = accession_pattern.findall(data)
        accession_numbers.update(found_accessions)
    else:
        id_list is None

    return list(accession_numbers)  

def fetch_all_geo_accessions(keyword, max_results=2000):
    all_accessions = set()
    retstart = 0
    while True:
        geo_ids, total_count = search_geo_accessions(keyword, retmax=max_results, retstart=retstart)
        if geo_ids is None:
            break
        else:
            accessions = fetch_geo_accession_details(geo_ids)
            all_accessions.update(accessions)
            retstart += max_results
            if retstart >= total_count:
                break
    return list(all_accessions)

def save_accessions_to_sheet(accessions, directory='/Users/swetarai/Downloads', filename="geo_accessions_clinical_trial_oncogene.xlsx"):
    file_path = os.path.join(directory, filename)
    df = pd.DataFrame(accessions, columns=["GEO Accession Number"])
    df.to_excel(file_path, index=False)
    print(f"Data saved to {file_path}")
   
    
keyword = "Oncogene"
max_results = 20000
geo_accessions = fetch_all_geo_accessions(keyword, max_results=max_results)
save_accessions_to_sheet(geo_accessions)


def fetch_pubmed_ids_from_geo(accession_list):
    base_url = "https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi"
    metadata = []

    for accession in accession_list:
        url = f"{base_url}?acc={accession}&view=full"
        response = requests.get(url)
        soup = BeautifulSoup(response.text, 'html.parser')

        pubmed_ids = []
        for a in soup.find_all('a', href=True):
            if 'pubmed' in a['href']:
                pubmed_id = a['href'].split('=')[-1]
                pubmed_ids.append(pubmed_id)

        metadata.append({
            'accession': accession,
            'pubmed_ids': ', '.join(pubmed_ids)  
        })

    return metadata

file_path = '/Users/swetarai/Downloads/geo_accessions_clinical_trial_oncogene.xlsx'
df = pd.read_excel(file_path)
geo_accessions = df['GEO Accession Number'].tolist()
geo_metadata = fetch_pubmed_ids_from_geo(geo_accessions)
metadata_df = pd.DataFrame(geo_metadata)
output_file_path = '/Users/swetarai/Downloads/geo_pubmed_metadata_clinical_trial_oncogene.xlsx'
metadata_df.to_excel(output_file_path, index=False)
print(f"Data saved to {output_file_path}")

def cleaning(file_path='/Users/swetarai/Downloads/geo_pubmed_metadata_clinical_trial_oncogene.xlsx', output_file_path2='/Users/swetarai/Downloads/updated_geo_pubmed_metadata_clinical_trial_oncogene.xlsx'):
    df = pd.read_excel(file_path)
    df['last_word'] = df['pubmed_ids'].astype(str).apply(lambda x: x.split()[-1])
    df['numerical_id'] = df['last_word'].str.extract('(\d+)$')
    print(df.head())
    df.to_excel(output_file_path2, index=False)
    return df

import requests
from bs4 import BeautifulSoup
import re
import time
import pandas as pd


def fetch_pubmed_html(pubmed_id):
    url = f'https://pubmed.ncbi.nlm.nih.gov/{pubmed_id}/'
    response = requests.get(url)
    response.raise_for_status()
    return response.text

def search_nct_in_abstract(html):
    soup = BeautifulSoup(html, 'html.parser')

    abstract_div = soup.find('div', class_='abstract-content selected')
    if abstract_div:
        abstract_text = abstract_div.get_text()

        # Searching for NCT number in the abstract and trial registration sections
        nct_match = re.search(r'NCT\d+', abstract_text)
        if nct_match:
            return nct_match.group(0)
        # Checking if there is a trial registration section
        trial_reg_div = soup.find('div', class_='trial-registration')
        if trial_reg_div:
            trial_reg_text = trial_reg_div.get_text()
            nct_match = re.search(r'NCT\d+', trial_reg_text)
            if nct_match:
                result =nct_match.group(0)
            else:
                result =None
            return result
    else:
        return None

pubmed_ids = [ 34880496, 31735169, 34242269, 37425921, 35266275, 30867030, 37842094, 38807216, 33068050, 32596459, 35504291, 39169200, 38294692, 36351009, 38339304, 34901353, 34762647, 29713003, 22955616, 30710146, 34890565, 32956651, 32326415, 32157212, 32188705, 32891189, 38352301, 38410476, 34162555, 39337374, 37728308, 37060567, 35350386, 30405152, 38047585, 36476851, 36607777, 36715552, 32499547, 32628295, 37549258, 37806842, 30119690, 37781087, 37500731, 34147104, 31694959, 36938415, 31797920, 29655599, 38307025, 37169737, 29105654, 39412501, 31911584, 33930311, 31048357, 31292138, 32323443, 32888955, 33627784, 38886591, 35197447, 32907838, 35443279, 29765154, 35837267, 33117517, 37889078, 36273157, 33608386, 36241617, 38993727, 31015574, 38418875, 37363990, 35492873, 29864419, 29605182, 33972799, 31757180, 38981482, 34037658, 39372038, 32471953, 32492394, 38965263, 39037997, 39209451, 38702730, 39373630, 36522653, 33951110, 30894502, 37807875, 31334602, 29802314, 38402212, 30910991, 36536122, 34050151, 32248641, 35802025, 39312663, 36522653, 29954933, 36029766, 37808852, 37167403, 36075976, 34719426, 30345971, 30418174, 32956836, 35399501, 34675201, 34675201, 37457440, 36148946, 32029688, 30033198, 38344143, 29748249, 34885022, 30849367, 34951993, 29802314, 36261015, 32016422, 31068365, 37126559, 39254172, 38025785, 33674350, 32244355, 31935369, 38316746, 37553321, 38817856, 39062774, 34610301, 34647996, 37060567, 37696947, 39277592, 36306264, 31375671, 34905511, 31784357, 38410476, 35178390, 29096160, 36207533, 31391555, 30645970, 34419492, 38981482, 35494243, 31402304, 37095099, 36778670, 32795421, 39337374, 35732128, 34731632, 37523894, 36920903, 37627217, 33748130, 37246217, 37142692, 32606137, 38316746, 36321792, 35915142, 34737198, 33259601, 38580649, 30078555, 37396509, 31148378, 33374731, 38570533, 35502723, 36816948, 31913116, 31116977, 37399271, 33045065, 33239721, 37258527, 36841849, 34440533, 38115228, 37767562, 32076484, 37889078, 37516102, 37500731, 35262195, 31086333, 37024465, 36384095, 38643157, 39369448, 38811525, 31350327, 34023294, 33328637, 33983114, 39052477, 33767190, 32541668, 35646092, 35771494, 30860996, 29641996, 33738287, 39212406, 39449023, 38975886, 37953789, 37296466, 36321561, 34586829, 30840885, 34145248, 39257805, 37460697, 37380804, 33789089, 29958106, 34844082, 39052000, 35228570, 30389925, 38997257, 33431820, 32787886, 31332348, 29161413, 31462705, 31875554, 38351382, 31619506, 34610301, 31985402, 39464133, 29892061, 33825680, 31874105, 32711549, 38460517, 32719743, 31267692, 29367463, 30126925, 37841755, 37742993, 33268821, 38842383, 36071275, 37729426, 31468695, 32934023, 31148594, 38720882, 29777010, 36183832, 33045065, 30810966, 37902422, 38054553, 36596776, 32552404, 35562350, 35228570, 36306781, 33506575, 39390150, 32203164, 37626123, 30995478, 38508140, 30952905, 31681329, 30842218, 32188707, 31209209, 34236315, 39158067, 37170094, 35739379, 39454000, 34880496, 29434411, 38049829, 38153787, 37604687, 33782537, 28759028, 35472162, 37549258, 34389725, 37161053, 28898697, 35477713, 29263384, 36693875, 35288713, 32667968, 31138768, 32351783, 38460517, 33211885, 29164052, 30745086, 35801156, 33602823, 31899800, 31039138, 38800827, 32633781, 39235528, 33299180, 30885981, 33980863, 31817155, 32269030, 22955616, 33382850, 31101122, 36222846, 31138842, 38040699, 32286315, 33005010, 30069049, 29720585, 36724291, 36075976, 33649045, 36656711, 34354236, 34586829, 36171613, 34294917, 34632715, 29472714, 33796454, 38862535, 30496486, 31597089, 37729426, 32195332, 35996586, 29199958, 31085176, 37813166, 37137915, 37957414, 30562046, 39478230, 33402674, 37591859,
39174739, 37314324,
38458187,
36808133,
31200764,
28974650,
28867293,
34262016,
36107780,
38181050,
36377663,
33529175,
30563891,
32333838,
32499646,
37423893,
34130714,
33851955,
34711612,
35216965,
37872156,
34775465,
31133691,
31796585,
32851022,
36120720,
34610301,
34271981,
31053162,
37739936,
31557131,
32901003,
30413718,
29045843,
38426339,
37662218,
29440228,
32054830,
38040699,
39301202,
33594072,
34301758,
38678233,
39592836,
33602783,
33414552,
22955616,
37257453,
31534224,
32035111,
38975886,
30796221,
29719259,
36522653,
35947961,
34389725,
38000027,
37857525,
33980863,
32841602,
29650789,
33720298,
30651288,
30139998,
33330931,
37709746,
33691114,
39478230,
31185214,
30303712,
31316462,
30503706,
39213127,
39322771,
33420368,
31819003,
34348652,
31292500,
38081939,
32071317,
33298911,
38702773,
33903675,
36818350,
39210147,
37756381,
31852898,
33886505,
33531590,
37224019,
31760766,
31162546,
38636893,
38458187,
33382850,
39267119,
32728173,
29891505,
36808133,
38334611,
39437166,
38316746,
35912092,
36335194,
34911733,
29954933,
29385522,
39414943,
35041461,
32372032,
29346507,
38458187,
36795481,
30220521,
37985676,
31257073,
33983114,
38759417,
31781169,
37468633,
30076409,
39337374,
32070401,
34890565,
29311308,
32559251,
33795875,
31937612,
35794478,
38729993,
38451249,
38959305,
39052477,
37020053,
37989747,
31332268,
36396656,
36841849,
19691111,
29467282,
38410476,
36368321,
34951993,
31044434,
35513575,
39277181,
38702730,
38366255,
33224878,
35205085,
37768068,
31014355,
38462574,
20480226,
31585941,
37170094,
35015732,
37494934,
37414763,
34848679,
37782459,
31287994,
31048320,
30290143,
35646902,
37967175,
31996670,
31071912,
38352301,
35882862,
21098324,
29670118,
31266962,
38627844,
39417215,
39478230,
37213689,
35732731,
38383514,
30385846,
36687526,
38573819,
35802025,
34387660,
39271776,
39561220,
37327788,
36563682,
36384103,
36170822,
31511698,
32068780,
36907523,
36563682,
39530749,
37623817,
32392629,
34399705,
33915081,
36075976,
35562350,
32891189,
37987362,
30270123,
30952871,
37989753,
37387154,
37540187,
34951993,
30670377,
31735169,
38056453,
33691110,
39390150,
35247892,
31088931,
32471953,
34936134,
36725920,
29284669,
38280869,
33654205,
31985402,
36075976,
29967493,
33149261,
34707143,
33737539,
35837267,
34244292,
39454579,
39270646,
39015786,
36729835,
32728244,
34163069,
31149037,
38412274,
37285225,
34622806,
35217790,
36185374,
35935955,
30012564,
31488818,
38931234,
38688275,
34301758,
34782719,
37387154,
36476408,
38702730,
37380804,
34741023,
35732731,
30918060,
33886505,
39312663,
31868166,
38410476,
38948355,
36211815,
34610301,
32251364,
31197180,
29414946,
36018850,
35535692,
36075976,
32503257,
39083415,
30926969,
33453168,
34644563,
33536616,
33058300,
32792398,
34337362,
36164607,
31461651,
39121370,
39408697,
37730746,
30484104,
32912902,
29249668,
30340042,
29439516,
30258192,
36300627,
34337561,
32855205,
36907523,
36879006,
38047585,
31511524,
31335327,
37626123,
36194647,
37167403,
32498018,
36949074,
35939046,
35472162,
38036590,
31735169,
38422172,
38868185,
37626123,
38670972,
37565374,
29198829,
35705990,
30537986,
37934799,
36461070,
38671504,
33947304,
36069770,
32459171,
37055441,
32735620,
29051323,
38811728,
38319971,
38570506,
37500731,
38702730,
36753044,
35021076,
32938922,
35584893,
29311158,
35932893,
31277676,
34059508,
37516102,
36097051,
32573490,
35513575,
30408148,
33839593,
33436496,
33361815,
33067475,
32645861,
32427329,
37587336,
30665463,
29284669,
28892090,
38253219,
33176887,
30858363,
30385738,
32717742,
38294344,
37285354,
36453584,
30554962,
34990589,
32442403,
34353854,
37987362,
38975886,
37060567,
36207533,
31988496,
29468485,
37756381,
36906109,
35927247,
35545049,
33077732,
30135308,
37945900,
29317678,
35837267,
37723306,
37460542,
33649045,
29383112,
30088816,
35852797,
37248394,
39277181,
34934837,
31231679,
31935369,
33318037,
31085176,
35021076,
35705990,
38593809,
35120601,
34236315,
38944837,
39179580,
38169329,
36928090,
32016422,
35536646,
31666572,
32916216,
37186300,
33072561,
38219875,
33313420,
35857848,
32024842,
35256673,
36171202,
31253784,
39225558,
35472162,
37938972,
37949862,
36930718,
38294344,
37407562,
33404608,
37716913,
30562046,
38778427,
31796630,
31911451,
31375747,
28753606,
38426339,
37587336,
36536122,
39128653,
31399573,
37958512,
31478830,
34163069,
39388266,
33781756,
38237027,
31780666,
37167403,
38060451,
34183418,
33536616,
35197475,
38593809,
36599297,
39067570,
33720298,
37561629,
38508140,
36289205,
37399271,
33922599,
34131071,
31666694,
31048683,
37651233,
39071306,
36425957,
39121480,
34555356,
39134516,
35978192,
39122682,
37841755,
37729611,
34639154,
32203470,
34946167,
31862696,
34120146,
23867226,
31665635,
38942017,
35624662,
33644712,
33980863,
29749372,
31484655,
38316746,
36309561,
32939092,
36728436,
30069049,
36947815,
33229459,
35736563,
37407562,
33972799,
39071306,
32901003,
37948630,
36858798,
37102614,
37585496,
34381028,
38536927,
38182647,
35927247,
33172971,
36289205,
32707077,
32066931,
38837231,
33014872,
32912902,
29229854,
29983389,
36693875, 34741119, 35804837, 31996893, 38604128, 37607005, 34956864, 37146911, 35264144, 39270646, 31597089, 32440553, 33099471, 38902475, 37492374, 35058622, 33691114, 30392977, 35134344, 32939092, 39267119, 36922594, 33930311, 36119118, 33529175, 29954934, 38360902, 33720298, 36555673, 36131013, 38994678, 35124821, 36778670, 35228570, 31844057, 32431053, 36300627, 31248101, 39217152, 38937474, 30270123, 34782763, 34602069, 30345349, 38458187, 30643286, 39368973, 38821858, 36928090, 32669548, 35732731, 32728700, 34296805, 32393731, 35259493, 32188707, 36159594, 30884851, 37029109, 38729993, 33514539, 31257073, 36044839, 32546717, 39039076, 38280869, 37919421, 33133148, 38114474, 36882421, 37623434, 38811728, 37988164, 33443202, 32907838, 37060567, 38153787, 35776116, 38538798, 39281020, 32351783, 30733195, 32954360, 30312732, 38049564, 34232320, 34088716, 32934023, 34965434, 33224878, 33654205, 32058953, 32707077, 35623341, 38325375, 36364387, 35393546, 37129912, 33597251, 33328217, 33453168, 29954933, 34830866, 30659195, 35813477, 35077705, 32647865, 37344599, 32831172, 34050151, 37762032, 34930894, 37925449, 35857848, 32358491, 36841849, 37696947, 33878293, 35461365, 35773268, 34375004, 32629178, 37494934, 37739936, 31511698, 35835915, 37258666, 31974192, 32471953, 37756381, 31911938, 37270580, 37267953, 34142094, 38916965, 34630428, 35134344, 34655667, 34741119, 35502723, 32133433, 35044826, 30021836, 36585452, 35837267, 31875554, 39083415, 31039138, 36930718, 31158229, 38458187, 38826330, 37244387, 32398827, 33499165, 37845228, 37945900, 32511321, 35322042, 30745086, 37611093, 39312663, 36449545, 38182647, 39694040, 30700838, 29136504, 31375747, 36922594, 22955616, 35477713,
37658059, 36088362, 38000027, 36070378, 38339304, 31439820, 34607937, 37029109, 33644767, 35477713, 37739936, 30365520, 36229514, 33397922, 30597648, 38483712, 30484104, 36705973, 32129880, 37747807, 31406347, 35044826, 37699967, 38848365, 34117242, 34003256, 34088716, 35852858, 38460517, 36202613, 31151404, 39384814, 29396395, 32358491, 36433955, 31892336, 38536921, 37057595, 33570624, 32573490, 39232498, 30886319, 33712615, 29444071, 30209397, 39312663, 39281020, 32891189, 29249668, 35646902, 28898697, 34003256, 33395700, 32616503, 33741901, 37995682, 37509260, 22955616, 38663407, 33792944, 37563311, 37105989, 35039672, 39121480, 34471141, 33045063, 31209047, 37082139, 36388465, 38110836, 32717742, 38800827, 36930718, 32068780, 38448751, 34247146, 31530804, 30453624, 37307443, 38459020, 36847778, 35477713, 28940826, 29195073, 36947815, 28754664, 34569060, 37728504, 35081348, 38153787, 36656864, 38605297, 33483370, 32903551, 36436682, 34880496, 34881186, 25538889, 32939092, 35732731, 35197475, 30252918, 34244292, 39257788, 37513116, 35704583, 34663724, 29452344, 33097530, 33514539, 34781731, 37082139, 32719551, 37914939, 31652979, 34079898, 34296805, 38800827, 38047585, 36457077, 34951993, 38948758, 34548623, 30659143, 30478407, 37729611, 30745086, 37246217, 32102997, 32029688, 36646721, 36387080,
35653194, 36618440, 36376974, 33239721, 35915142, 30014851, 30467381, 33188013, 37735514, 29423054, 37587336, 38277141, 38048223, 36537914, 39178842, 36153311, 34585448, 34439480, 33070870, 37081259, 32680987, 31242205, 31420371, 36341435, 38066116, 38462574, 37658059, 38040699, 30926782, 29954933, 33780491, 35501464, 33536616, 32974198, 30630822, 37931130, 36204272, 30496486, 32753692, 39257788, 36373710, 33662273, 32891189, 31005419, 37461053, 37691115, 38658752, 34564690, 31913116, 32997960, 36634204, 29136005, 32855205, 30449725, 37893029, 38253266, 38513139, 36457025, 36922594, 30810966, 37170094, 31666572, 35738865, 34782763, 37311463, 32928922, 37344599, 32304665, 35603967, 32998338, 32717742, 33997693, 38942017, 29665859, 31346162, 38975886, 29576454, 37026477, 37676710, 32954360, 34933939, 38813729, 30718512, 29891505, 36922594, 31263101, 37258521, 36711674, 38604128, 36849026, 31934613, 31670864, 37739936, 37735514, 35914530, 33782087, 34731632, 30723296, 36930718, 39472576, 32531202, 39372038, 37029109, 37737260, 32358491, 37704631, 32199616, 39199284, 37082139, 35895495, 36351009, 36251879, 32346380, 35513575, 38781960, 36075220, 34120146, 34011996, 32882850, 31570506, 39213127, 38981482, 37484164, 33839593, 33726845, 31266935, 29362363, 32181817, 38720889, 38410476, 37285399, 36640339, 34301758, 36656864, 35354467, 34001994, 33983114, 33067475, 35115371, 34771656, 39121370, 35869673, 36922594, 31666572, 33758101, 30209397, 33453168, 34470666, 35247925, 33863883, 37547972, 39479752, 35201318, 34711913, 30409903, 29115935, 37478862, 36309561, 38139172, 36944332, 35987910, 31175057, 31044434, 31101763, 38821858, 31334602, 35530152, 31988496, 38530115, 33886505, 32629178, 31219154, 33060649, 38920655, 38640251, 36539401, 34869264, 30220521, 29892061, 34088868, 38604128, 37838757, 36670102, 36414416, 38056453, 31869378, 31048689, 38065100, 33951110, 35978192, 31775039, 37947765, 30953031, 39083088, 36203755, 32220303, 34357133, 39232216, 36882421, 31018144, 36285442, 37314324, 35662392, 37550515, 31149037, 33930309, 36342298, 39186651, 30671225, 38600391, 38049829, 29476010, 36624093, 38294344, 30366908, 37760589, 35323110, 30002083, 33644767, 35305370, 32542325, 30135308, 37057595, 31358774, 36874405, 37422628, 37094160, 35110400, 38858602, 36449545, 39468006, 34624089, 36300627, 28981542, 34232320, 36930718, 34071089, 36210625, 38886591, 38181050, 34916557, 35502723, 31358969, 29373830, 31378673, 36858798, 37459233, 34010744, 34314419, 35802025, 32243838, 31511524, 31296529, 39198404, 38418883, 29233926, 36599297, 35832114, 35327394, 38300710, 33077574, 36749874, 35232969, 36253572, 36845684, 30962207, 31307377, 37878417, 39478230, 38001268, 37770430, 28832682, 34804931, 37224504, 37938344, 38460517, 31761563, 36991126, 31199785, 37643018, 37478172, 35764649, 37338984, 29893976, 36930718, 32351783, 39089631, 38915555, 32463822, 39021835, 32471953, 38593809, 39121370, 39530749, 34174920, 36271032, 34944900, 32001757, 34039964, 35837267, 36425760, 35636967, 38755155, 36599297, 35223194, 27333029, 34302042, 34163069, 31039138, 34433918, 31690671, 30455465, 36670046, 34737261, 33244099, 37026477, 36075976, 37246217, 35794478, 37310065, 35697349, 39137777, 34857874, 35820706, 35533313, 31015574, 32817263, 29454790, 34172737, 34624089, 33033262, 36995340, 32169218, 39151930, 36536122, 39134516, 25538889, 31780666, 35574319, 38431880, 38307867, 35121645, 28135249, 38048223, 32763232, 38513139, 33767190, 30745086, 37696947, 33268347, 32180900, 38302473, 38585663, 39271958, 31420543, 32956836, 32937140, 35974102, 37500731, 36018850, 34952892, 31761532, 32418298, 37254100, 37934799, 36841849, 35444650, 37880271, 31444232, 39357875, 39456897, 32555459, 29795241, 29954933, 33149261, 38709925, 36253572, 37995682, 30924641, 34997107, 30531871, 35513575, 31881074, 34236315, 37029109, 34172714, 34601571, 30332650, 33972799, 36201246, 38963038, 33323974, 32341020, 30343527, 34471141, 31478830, 31923801, 30074477, 29249668, 39213127, 33654205, 32203470, 37343073, 29891505, 34442440, 35041461, 32897512, 32445454, 32939092, 35597236, 38958646, 38821858, 33579893, 37384539, 36947815, 30475207, 22955616, 30074477, 39322771, 37945900, 36922511, 34824288, 31881074, 35857625, 31733993, 31484655, 33825680, 39270646, 33854168, 34529467, 35562376, 37934799, 34382935, 37914939, 31780666, 35245687, 38590653, 39109936, 38625747, 37468633, 37125639, 35776116, 35764649, 32392629, 37563155, 37060567, 38580649, 31005419, 38701369, 37729426, 39571575, 36148946, 39052835, 38063857, 30125329, 38958646, 36944332, 32012866, 33239721, 38759645, 32901003, 35568821, 38703814, 34646987, 34903606, 30349062, 32934023, 35565457, 35732128, 31582393, 39137777, 39039076, 34622806, 32939092, 32753546, 31558567, 35454913, 33298911, 35105690, 34354236, 31231679, 36858798, 32589943, 33754068, 36670102, 37468105, 35732731, 37696947, 36052716, 32667968, 31973890, 35120601, 31467127, 33651821, 38748792, 30890554, 28898697, 29379199, 36973243, 35705990, 34610301, 33930311, 38821061, 32862732, 34675201, 38701369, 31527595, 30256975, 38381406, 35228570, 38720882, 33911178, 34732713, 33821796, 35571674, 34172737, 34848725, 34911763, 35304506, 35974102, 34077955, 34408137, 34508101, 36705973, 33767190, 35460072, 30220521, 32331451, 30651601, 39433793, 36262061, 28898697, 36841849, 38892065, 36271053, 38678233, 31840941, 37210549, 37235653, 37082139, 33817986, 31231679, 34880496, 38593781,
33188013, 34271981, 31631019, 31208318, 30926878, 34951957, 37380804, 38720882, 33001025, 33763698, 34751773, 35935976, 39039076, 32358491, 22955616, 33542080, 34611148, 37176052, 33194615, 39571169, 32243838, 37580540, 34162697, 37943631, 31712600, 35093137, 37425921, 30926878, 39201282, 37055414, 39433816, 36715552, 34952892, 36930718, 30554962, 30943405, 39312663, 30115695, 32661325, 35122057, 32923585, 39235528, 36894688, 39454110, 37500731, 38458187, 34610301, 36648336, 34445617, 37901240, 35916066, 32684154, 33602789, 35041461, 31882655, 36590164, 38570506, 37872156, 39522321, 31511698, 33859327, 38934080, 39178842, 31444232, 32882403, 36171202, 36922511, 37407562, 34995493, 39178842, 37704631, 32987735, 35883003, 39097623, 36542473, 39448591, 38588409, 36075976, 34387660, 37452056, 32916216, 31631019, 36161469,
38315865, 35783607, 34965583, 35628321, 34380634, 39454579, 33479171, 37057593, 39263139, 36163549, 33626352, 30475207, 38605297, 35421371, 37889078, 38040699, 36922594, 37304266, 34778614, 30343527, 30596634, 33945793, 38678233, 36253572, 32843692, 31461442, 31053162, 35228570, 32822486, 31553483, 30926878, 34316693, 29491412, 36906109, 36130229, 34485650, 36384095, 34078608, 39227594, 35886011, 37129912, 37931130, 32851594, 30930117, 31612958, 32304665, 31101763, 37587336, 37995182, 37399271, 35734930, 36882421, 38056453, 33574613, 36841849, 34555336, 30202007, 37055441, 35866661, 33247761, 33712615, 30013058, 32934023, 35105803, 30074477, 35536646, 30523719, 38702730, 39478206, 30279449, 38167224, 38748792, 35090594, 37330596, 34236315,
29440633, 34642317, 30205047, 37739938, 36287107, 31371485, 33602823, 36841849, 34944900, 37387154, 33836152, 38076897, 31406165, 39537753, 31015574, 34096681, 31462705, 38927507, 33188013, 39189258, 32974204, 31346162, 30003124, 34226710, 35021076, 31147469, 32076484, 31375671, 31266962, 31053162, 31819055, 34980123, 33361815, 31685994, 34348652, 32907838, 38352301, 29622580, 34174920, 37873786, 35053617, 35801156, 37749153, 35562350, 38521502, 38513139, 38168062, 36476851, 38886591, 39103541, 34610301, 35835117, 34059508, 31605540, 38605363, 35748745, 31511698, 37071673, 34789165, 33149261, 29321003, 31148594, 33594072, 38657045, 31754186, 31638150, 37889078, 36433955, 35732731, 37923752, 36306264, 37380804, 38345384, 38670101, 31796750, 38965263, 30332632, 30349559, 39103541, 38480976, 30717152, 33832990, 38747345, 39478230, 35906240, 31273062, 36055199, 38822082, 31263101, 38975874, 32730594, 34143979, 39282450,
29795241, 38360902, 32788653, 33020477, 31527824, 33637522, 34359754, 31375747, 37278344, 31804471, 31802004, 31937612, 29617759, 34711913, 38944837, 30863496, 39186651, 38948355, 32446320, 34890565, 32581250, 39478230, 29383112, 37735513, 34795418, 38538798, 36831504, 30359577, 32034218, 31164413, 39104474, 33067475, 32471953, 32341020, 30745086, 36585450, 36599297, 38457494, 33298911, 35156727, 33149299, 31937612, 31603918, 34544797, 31101763, 36357424, 38000027, 37845228, 31439820, 30068375, 33990344, 33497366, 32822486, 38153787, 31300558, 35545049, 35783678, 30745086, 38561347, 35687133, 29892061, 36253572, 34802044, 29941549, 34009137, 38462574, 30962695, 33323928, 37691636, 37041291, 30584073, 38577020, 35951677, 35886011, 29802314, 37192295, 33023985, 37500731, 33707235, 33514539, 36201246, 34386013, 31378680, 39388266, 37877568, 32887689, 29454790, 35205651, 34782763, 33407852, 32237061, 36123629, 30745086, 34037658, 36368321, 38685100, 39277592, 35523804, 29284669, 30270123, 32573490, 39267119, 38709925, 32575420, 35510530, 32409593, 32553121, 36661191, 31935369, 32358491, 33712563, 35633941, 37267953, 34315896, 30880155, 32816843, 30366908, 30143481, 30988157, 37094356, 34529467, 34667030, 30107177, 36461070, 34493732, 31865182, 29898915, 33430890, 29906244, 34120146, 36656749, 29638215, 35565457, 32690724, 37468633, 39312663, 32690540, 39177582, 34471141, 37552050, 36449545, 35119792, 37945901, 34555356, 38592717, 31689243, 36394953, 35405009, 32390003, 30712876, 38076897, 34622806, 33328572, 38600376, 38811728, 36449545, 33852917, 37516102, 32239647, 35857848, 39201282, 32321829, 33149299, 30584073, 38053165, 29511348, 30635434, 37295428, 37137915, 35764649, 30069049, 39372038, 35961968, 39555410,

37591242, 35271824, 33158842, 38413989, 32341020, 30568033, 39372038, 29808006, 29723998, 38409325, 37246217, 31361039, 37232385, 35272288, 38536927, 37543088, 35156921, 34117065, 35316100, 35499757, 37989753, 31151404, 30135308, 30389848, 21098324, 37407554, 36808133, 33980863, 35076948, 35623341, 34088716, 37709746, 39441902, 37402366, 37060567, 36720042, 37967175, 35132075, 38982514, 38750365, 36599297, 28806777, 30422115, 31775039, 37729611, 31151404, 30940805, 32188026, 34283887, 29691399, 31257073, 31039827, 32089544, 32157212, 36108018, 37674118, 34399819, 30954952, 32203470, 37336885, 35974102, 33931740, 32730594, 32707077, 29505847, 38110836, 33674596, 34955846, 31263101, 32321829, 32068780, 33054052, 33328637, 30503706, 39483921, 34260908, 32269030, 32647357, 36323660, 39121480, 36656933, 34305997, 29396902, 37863665, 34330898, 33124133, 36322759, 39178842, 33299180, 33754068, 31257023, 38226414, 34003256, 35476451, 33357452, 37344599, 38409079, 30076334, 35884401, 38615319, 30503706, 31492046, 32621641, 31109321, 38426339, 34775841, 38409325, 38505604, 29681454, 37995682, 39207369, 33626321, 38942017, 37295428, 34508101, 39277181, 36108018, 37626123, 32937437, 35468895, 38253266, 35562350, 32554710, 37336885, 30021836, 38504371, 33945506, 38126767, 36384095, 35732128, 32341020, 30670058, 34836157, 32717742, 35979358, 39257788, 32286315, 35536646, 33928261, 38463444,

35420133, 38056453, 37407816, 32058953, 31444334, 34006647, 35700772, 33046784, 38422172, 38512964, 39257788, 37968399, 33527899, 28983113, 29804837, 38431880, 34249932, 36585450, 37468633, 33259779, 34092790, 38965534, 36351009, 38339304, 29533787, 36103824, 33882314, 29446526, 38508140, 33462507, 39137777, 31744829, 34769070, 31048498, 38194271, 35194192, 39277592, 32934023, 38458187, 35503086, 37807875, 34050151, 34333552, 32816905, 34426512, 38253266, 30573629, 37626123, 38570533, 35883107, 38778427, 37531234, 36852644, 32573490, 38821858, 35361816, 33138797, 39095540, 36800413, 35355015, 33574609, 28736556, 37295428, 38709925, 38126767, 37626054, 35802025, 35496311, 31618629, 34209035, 33299176, 37407562, 38854737, 29343578, 38815928, 31804471, 37705067, 33602823, 37041291, 38318072, 30404791, 34741119, 30087114, 31965581, 38291516, 31243293, 37053555, 30992691, 37674528, 39335143, 37407562, 37082139, 33825680, 31346162, 38593809, 33602823, 35041461, 32738449, 34671012, 37553760, 34408137, 36922511, 33786580, 39039193, 37607005, 38942026, 33097530, 28898697, 32437590, 37292952, 34050151, 29304191, 30014851, 32332020, 35222378, 29942092, 35523804, 37709746, 32601467,

34608310, 36947815, 32749006, 37842081, 32188026, 36805688, 33536616, 38458187, 32188026, 30858363, 29954325, 38766212, 32142683, 35764649, 39283720, 31900415, 31231679, 31243106, 33574609, 36322632, 30456364, 36582823, 31266633, 36008411, 31159814, 37863665, 38922866, 35288574, 29719259, 37735513, 30540933, 32203506, 36357424, 34562087, 32246016, 33593880, 34911787, 33414552, 34096681, 31511524, 34399888, 35503721, 32966797, 36368321, 36207533, 37625403, 30038221, 36170373, 38183981, 33825680, 39388266, 32024842, 37500731, 34788382, 38426275, 38338881, 31973890, 36976323, 31618627, 30745086, 38426579, 38344143, 30401716, 32855205, 39134516, 32341020, 39009595, 37573408, 34381210, 30093397, 39113654, 37863665, 38285896, 39037997, 36724799, 36044839, 31786140, 39103541, 37626123, 36637394, 33897436, 33674746, 38678233, 29138277, 30596634, 30025876, 31511513, 30630822, 33298911, 34737261, 35886011, 37790365, 34857874, 33453168, 38702730, 39100099, 32618511, 34531315, 39454579, 34389725, 37705067, 34321240, 34592752, 37151890, 33356791, 29674595, 29786076, 28898697, 35878022, 35461328, 36253572, 33149265, 22955616, 34413462, 35499757, 29515880, 31231679, 39281020, 35623341, 32284990, 39455282, 37344157, 38056453, 35801156, 31780666, 35835117, 39569145, 33097058, 38036590, 32203470, 39043191, 30891063, 39179580, 34391772, 32166015, 37252969, 31631019, 37816716, 37727007, 34973294, 36370852, 32589943, 29893976, 36715552, 33898319, 39147845, 33431820, 34035375, 32298266, 39322643, 32195191, 34782763, 34857874, 33298911, 34587247, 34423776, 33397922, 31048683, 30108282, 29719262, 29728077, 38126767, 34079898, 35134344, 32366477, 39158067, 35115686, 35980387, 38383676, 39213127, 35858545, 30867030, 35545049, 31231679, 32816859, 32717742, 32939092, 33318037, 39348888, 37200088, 35260583, 31804621, 31914399, 31831736, 38834071, 37945900, 39151930, 36139061, 38040699, 38975897, 37330071, 29617667, 30718512, 36914141, 39372038, 39277592, 37566052, 33536616, 34788079, 38011999, 39254172, 32994205, 37129912, 31935369, 34782763, 37500731, 34951993, 32284990,

32203470, 33318037, 32243838, 34622806, 35732731, 30463015, 33602823, 34428301, 33931882, 35550508, 32939092, 29804837, 33574609, 30335683, 34744970, 30891063, 36503426, 38426339, 37961132, 33443202, 35263037, 21306997, 38866344, 34711612, 36848578, 36848831, 33985562, 32651256, 36947815, 35973424, 38462574, 30894502, 29248441, 33047672, 29284669, 35134344, 36907523, 37914939, 35706127, 31527595, 34462284, 28900044, 38570506, 36670046, 31519689, 30696953, 36476851, 31511698, 29954933, 38538798, 31748743, 37751459, 33911076, 39332710, 36287107, 33811251, 37563311, 39267119, 38401418, 33064565, 32977749, 32086391, 36477656, 34675201, 34878671, 33188013, 36273157, 35211358, 38410476, 36323661, 33058300, 30095598, 38280869, 30305285, 30341213, 39587064, 36725889, 38167224, 38110836, 33983114, 36513728, 29844011, 36161484, 35835117, 32071317, 30210809, 38049829, 33820821, 33947961, 37246217, 37450593, 32707077, 34936134, 37555357, 31407334, 38000027, 38570506, 38749609, 32714570, 33980863, 31619506, 33536616, 33527899, 37452056, 38412274, 31825825, 35186752, 38702730, 36260562, 31371381, 33149261, 38663407, 37277530, 32358491, 30102401, 31334602, 34795225, 36171202, 34188179, 36599297, 36793594, 31985402, 37891670, 34121659, 35676392, 32825530, 35210413, 31511698, 33117517, 33693707, 38418883, 36477537, 34521827, 39103541, 36720042, 34711612, 30558585, 35737447, 36596811, 32157212, 37922339, 38975874, 37025992, 35837267, 33990344, 31350286, 31127282, 34873338, 31781162, 35197475, 39189458, 35978192, 34529467, 33127746, 35545049, 36705973, 39232498, 39052835, 29386185, 35510953, 39039076, 39271958, 32398865, 29958106, 38956608, 38600391, 38821858, 32738616, 34335918, 33662273, 36179280, 31240244, 33150660, 35378133, 39372038, 39235528, 37626123, 31545012, 33601056, 31183403, 33523865, 36197962, 33951110, 22955616, 31775039, 37330596, 32895418, 31822797, 30106105, 36670046, 39478230, 39468006, 35399501, 34539729, 30837581, 30146162, 35914530, 39113695, 38678233, 37973913, 38800827, 34815341, 31883160, 33436496, 39277181, 38678233, 38211442, 34193871, 35074757, 33637692, 31266868, 33672732, 32822486, 35732731, 38600345, 31371485, 33786580, 35883689, 36253572, 37580380, 36329027, 38157851, 36253572,

36183362, 36846090, 39455282, 37587336, 38076897, 34555356, 37088914, 36476851, 29654229, 31243293, 34934837, 32891189, 38512964, 32150356, 34569060, 30961617, 38678233, 38053165, 38604128, 37716913, 30891063, 39121370, 29429824, 31597089, 37925424, 37729611, 33536616, 35021076, 38937474, 35771494, 31619506, 30744585, 38822082, 39390150, 34458146, 29518129, 38755258, 34885166, 38028209, 35452289, 32328985, 30205047, 32956836, 33510172, 38090581, 33644767, 34880496, 36309561, 39372038, 37208129, 37468633, 36947815, 36071275, 29281830, 38272902, 35857848, 32983994, 38234720, 32360601, 39227594, 32188707, 32029688, 31097636, 36171202, 29941549, 38040699, 32934023, 30429474, 38294344, 31148594, 38275864, 37626123, 30810966, 33028592, 35800060, 33911178, 32753692, 32490320, 33357452, 37278344, 39337374, 39467636, 29872037, 35246110, 36635563, 37278344, 31534224, 30341213, 37295428, 39186651, 37195124, 37914939, 33594072, 37973897, 36841849, 36461070, 30220457, 35969736, 32855205, 38698344, 37024492, 36287107, 34145038, 37611093, 37626123, 38294344, 38049829, 31446059, 30659195, 34521827, 37384539, 34163069, 29804837, 37709746, 33823531, 30924641, 33536616, 35666868, 32210272, 36604566, 37272756, 32351783, 36336953, 37626123, 37995682, 37078547, 35452289, 37922359, 35764649, 38976573, 34039964, 32967703, 39257805, 34604216, 37974970, 29440262, 39372038, 37494934, 31679823, 37425921, 37246217, 33453168, 35134344, 30069049, 34080665, 37550515, 37696947, 38755155, 38593809, 34795264, 35343073, 35074757, 31775028, 31553912, 29095436, 31174057, 35579943, 34302498, 32838807, 36273157, 36224471, 33662273, 31426861, 34529467, 29358707, 31037138, 38720882, 38821916, 37760589, 37341071,

31331399, 36224471, 31263264, 38144458, 37967356, 29234122, 37626123, 34408017, 38800827, 38045421, 32647357, 37572321, 38374113, 38942026, 36338974, 33372147, 38167224, 35405009, 32344427, 29958106, 37105715, 36563682, 35760778, 33619159, 33574613, 36123629, 30952905, 33911178, 39270646, 34197016, 37540187, 39227594, 35228570, 28753127, 36879006, 33203179, 37587336, 33644767, 38743809, 30415952, 34121659, 37873734, 37326110, 37468633, 31824855, 31911451, 34680511, 32934023, 29073104, 36185374, 35019856, 39571575, 34493732, 38451249, 37587336, 34348160, 35290801, 31053606, 33046882, 33483506, 38168996, 32019274, 31122259, 36928090, 33172971, 36358756, 35879396, 31322256, 38944837, 39043191, 39169233, 35794478, 36120720, 30459395, 39190349, 35666868, 33759265, 34936134, 38307028, 34117258, 36938415, 29868978, 29099092, 34051058, 33619557, 37254100, 29719259, 39134516, 37094356, 37878417, 36476366, 31435022, 37902422, 37957414, 39099209, 30218041, 37125639, 29287594, 34142094, 33792944, 38116118, 31978326, 39326063, 33627630, 34301758, 35021076, 30415952, 39349495, 32792685, 39103541, 31251810, 36544755, 33731926, 35444552, 35760778, 36373729, 36599297, 37938972, 30954952, 36044843, 37468633, 36140215, 31197017, 34073664, 31206197, 34707097, 36044839, 35978192, 34687205, 29468485, 34857958, 38056453, 37856433, 38997291, 34329586, 32086528, 33124133, 39083415, 38114474, 38925122, 30366906, 32051529, 32553121, 39079663, 37902422, 37552602, 35764649, 33450231, 33357452, 31375671, 39390150, 39372038, 30745086, 31891620, 33795875, 31911451, 34244292, 37729426, 36413141, 36892943, 37735513, 37729426, 37626123, 32409593, 32532008, 35071234, 37541243, 34670358, 34157105, 37913768, 30711935, 37108716, 38727236, 36171202, 36897214, 38383676, 37657757, 38671504, 30335683, 36075220, 33414552, 36429043, 34857874, 36656864, 34931757, 30639212, 30685712, 38778217, 37160509, 37129912, 34622806, 35000083, 38800827, 34880496, 38546612, 34604216, 35353883, 35443736, 36260562, 31775039, 37863888, 37452056, 31527167, 38409325, 34916628, 36172351, 30635626, 31915379, 39372038, 38755155, 38169329, 33511119, 34877501, 38458187, 32686676, 31515468, 31992204, 34569060,


]
results = []
for pubmed_id in pubmed_ids:
    a = fetch_pubmed_html(pubmed_id)
    if a:
        nct_number = search_nct_in_abstract(a)
        if nct_number:
            results.append({'PubMed ID': pubmed_id, 'NCT Number': nct_number})
        
        else:
            results.append({'PubMed ID': pubmed_id, 'NCT Number': 'NCT Not Found'})
    else:
        results.append({'PubMed ID': pubmed_id,'NCT Number': 'NCT Not Found' })

    
    time.sleep(1)

df = pd.DataFrame(results)
output_file_path3 = '/Users/swetarai/Downloads/updated_NCT_WITH_trial_reg_SEARCH_clinical_trial_oncogene.xlsx'
df.to_excel(output_file_path3, index=False)
print(f"Data saved to {output_file_path3}")